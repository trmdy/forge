# Swarm Configuration File
# Place this file at ~/.config/swarm/config.yaml

# Global settings
global:
  # Directory for Swarm data (database, logs, transcripts)
  data_dir: ~/.local/share/swarm
  
  # Directory for configuration files
  config_dir: ~/.config/swarm
  
  # Automatically register the local machine as a node
  auto_register_local_node: true

# Database settings
database:
  # SQLite database path (default: {data_dir}/swarm.db)
  # path: ~/.local/share/swarm/swarm.db
  
  # Maximum database connections
  max_connections: 10
  
  # Timeout for locked database (milliseconds)
  busy_timeout_ms: 5000

# Logging settings
logging:
  # Minimum log level: debug, info, warn, error
  level: info
  
  # Output format: json, console
  format: console
  
  # Optional log file path
  # file: ~/.local/share/swarm/swarm.log
  
  # Include caller information in logs
  enable_caller: false

# Accounts configuration
# credentials can be env vars (env:VAR or $VAR), file paths, or vault references
accounts:
  # Example account
  - provider: openai
    profile_name: default
    credential_ref: "$OPENAI_API_KEY"
    is_active: true

# Default settings for nodes
node_defaults:
  # SSH backend: native (Go SSH), system (ssh binary), auto
  ssh_backend: auto
  
  # SSH connection timeout
  ssh_timeout: 30s
  
  # Default SSH key path (leave empty to use ssh-agent)
  # ssh_key_path: ~/.ssh/id_ed25519
  
  # How often to check node health
  health_check_interval: 60s

# Default settings for workspaces
workspace_defaults:
  # Prefix for generated tmux session names
  tmux_prefix: swarm
  
  # Default agent type to spawn
  default_agent_type: opencode
  
  # Automatically import existing tmux sessions
  auto_import_existing: false

# Workspace-specific overrides
workspace_overrides:
  # Example: permissive approvals in a dev workspace
  - name: my-project
    approval_policy: permissive

  # Example: custom approvals for sensitive repos
  - repo_path: /repos/secure-*
    approval_policy: custom
    approval_rules:
      - request_type: file_changes
        action: approve
      - request_type: shell_command
        action: prompt

# Default settings for agents
agent_defaults:
  # Default agent CLI type: opencode, claude-code, codex, gemini, generic
  default_type: opencode
  
  # How often to poll agent state
  state_polling_interval: 2s
  
  # Time of no activity before considering agent idle
  idle_timeout: 10s
  
  # Maximum lines to keep in transcript buffer
  transcript_buffer_size: 10000
  
  # Approval policy: strict (always ask), permissive (auto-approve), custom (use rules)
  approval_policy: strict

  # Optional rules for custom approval policy
  # approval_rules:
  #   - request_type: "*"
  #     action: prompt

# Scheduler settings
scheduler:
  # How often the scheduler runs dispatch checks
  dispatch_interval: 1s
  
  # Maximum retry attempts for failed dispatches
  max_retries: 3
  
  # Base backoff duration between retries
  retry_backoff: 5s
  
  # Default cooldown duration after rate limiting
  default_cooldown_duration: 5m
  
  # Automatically rotate to another account on rate limit
  auto_rotate_on_rate_limit: true

# TUI settings
tui:
  # How often to refresh the display
  refresh_interval: 500ms
  
  # Color theme: default, dark, light
  theme: default
  
  # Show timestamps in the UI
  show_timestamps: true
  
  # Use compact layout mode
  compact_mode: false
