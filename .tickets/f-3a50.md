---
id: f-3a50
status: open
deps: []
links: []
created: 2026-01-11T17:50:37Z
type: epic
priority: 2
assignee: Tormod Haugland
---
# EPIC: fmail v1.1 improvements

## Overview

Collection of enhancements to fmail based on agent feedback. These improvements focus on making fmail more practical for real-world multi-agent coordination without changing the core architecture.

## Motivation

Feedback from agents (codex, relentless-landers) identified friction points:

1. **Watching multiple topics requires multiple processes** - TUI and routers need unified streams
2. **Timestamp-based resume is unreliable** - Clock drift, boundary conditions cause duplicates/gaps
3. **No message categorization** - Tags would enable filtering without topic proliferation
4. **GC is too coarse** - Can't clean noisy topics while preserving important ones
5. **No unread tracking** - Agents can't easily know "what's new since last session"

## Children

| ID | Title | Priority | Status |
|----|-------|----------|--------|
| f-752c | Multi-topic watch support | P2 | open |
| f-de22 | Cursor resume with --after | P2 | open |
| f-54c2 | Add tags field to message schema | P2 | open |
| f-f1e6 | Scoped gc (per-topic, --before) | P2 | open |
| f-e651 | backlog_done marker in protocol | P3 | open |
| f-f16c | Richer JSON output for topics/log | P3 | open |
| f-1fdb | Per-agent cursor tracking | P3 | open |

## Dependency Graph

```
f-752c (multi-topic watch)     f-54c2 (tags)     f-f1e6 (scoped gc)
         │                          │                    │
         └──────────────────────────┼────────────────────┘
                                    │
                              f-de22 (cursor resume)
                                    │
                    ┌───────────────┴───────────────┐
                    │                               │
              f-e651 (backlog_done)         f-f16c (richer JSON)
                                                    │
                                            f-1fdb (cursor tracking)
```

## Implementation Order

1. **f-de22**: Cursor resume - foundational, enables reliable replay
2. **f-752c**: Multi-topic watch - high value, independent
3. **f-54c2**: Tags schema - forward-compatible, low effort
4. **f-f1e6**: Scoped gc - independent, useful immediately
5. **f-e651**: backlog_done marker - builds on cursor resume
6. **f-f16c**: Richer JSON output - builds on cursor concepts
7. **f-1fdb**: Per-agent cursor tracking - final polish

## Success Criteria

- [ ] Can watch multiple topics in single command
- [ ] Can resume watch from exact message ID
- [ ] Messages support optional tags
- [ ] Can clean up specific topics without affecting others
- [ ] Client can distinguish backlog vs live messages
- [ ] JSON output includes metadata for TUI/debugging
- [ ] Agents can track unread messages across sessions
